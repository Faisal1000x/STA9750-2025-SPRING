<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Faisal">
<meta name="dcterms.date" content="2025-04-16">

<title>STA 9750 Mini-Project #03: Creating the Ultimate Playlist</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MP3_files/libs/clipboard/clipboard.min.js"></script>
<script src="MP3_files/libs/quarto-html/quarto.js"></script>
<script src="MP3_files/libs/quarto-html/popper.min.js"></script>
<script src="MP3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MP3_files/libs/quarto-html/anchor.min.js"></script>
<link href="MP3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MP3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MP3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MP3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MP3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-science-of-flow-building-a-progressive-electronic-music-journey" id="toc-the-science-of-flow-building-a-progressive-electronic-music-journey" class="nav-link active" data-scroll-target="#the-science-of-flow-building-a-progressive-electronic-music-journey">The Science of Flow: Building a Progressive Electronic Music Journey</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#data-acquisition-and-preparation" id="toc-data-acquisition-and-preparation" class="nav-link" data-scroll-target="#data-acquisition-and-preparation">Data Acquisition and Preparation</a>
  <ul class="collapse">
  <li><a href="#song-characteristics-dataset" id="toc-song-characteristics-dataset" class="nav-link" data-scroll-target="#song-characteristics-dataset">Song Characteristics Dataset</a></li>
  </ul></li>
  <li><a href="#playlist-dataset" id="toc-playlist-dataset" class="nav-link" data-scroll-target="#playlist-dataset">Playlist Dataset</a></li>
  <li><a href="#converting-playlist-data-to-rectangular-format" id="toc-converting-playlist-data-to-rectangular-format" class="nav-link" data-scroll-target="#converting-playlist-data-to-rectangular-format">Converting Playlist Data to Rectangular Format</a></li>
  <li><a href="#initial-exploration" id="toc-initial-exploration" class="nav-link" data-scroll-target="#initial-exploration">Initial Exploration</a>
  <ul class="collapse">
  <li><a href="#key-findings-from-initial-exploration" id="toc-key-findings-from-initial-exploration" class="nav-link" data-scroll-target="#key-findings-from-initial-exploration">Key Findings from Initial Exploration:</a></li>
  </ul></li>
  <li><a href="#identifying-characteristics-of-popular-songs" id="toc-identifying-characteristics-of-popular-songs" class="nav-link" data-scroll-target="#identifying-characteristics-of-popular-songs">Identifying Characteristics of Popular Songs</a></li>
  <li><a href="#correlation-between-spotify-popularity-and-playlist-appearances" id="toc-correlation-between-spotify-popularity-and-playlist-appearances" class="nav-link" data-scroll-target="#correlation-between-spotify-popularity-and-playlist-appearances">Correlation Between Spotify Popularity and Playlist Appearances</a></li>
  <li><a href="#popular-songs-by-release-year" id="toc-popular-songs-by-release-year" class="nav-link" data-scroll-target="#popular-songs-by-release-year">Popular Songs by Release Year</a></li>
  <li><a href="#danceability-over-time" id="toc-danceability-over-time" class="nav-link" data-scroll-target="#danceability-over-time">Danceability Over Time</a></li>
  <li><a href="#decade-representation-in-playlists" id="toc-decade-representation-in-playlists" class="nav-link" data-scroll-target="#decade-representation-in-playlists">Decade Representation in Playlists</a></li>
  <li><a href="#musical-key-distribution" id="toc-musical-key-distribution" class="nav-link" data-scroll-target="#musical-key-distribution">Musical Key Distribution</a></li>
  <li><a href="#popular-track-lengths" id="toc-popular-track-lengths" class="nav-link" data-scroll-target="#popular-track-lengths">Popular Track Lengths</a></li>
  <li><a href="#additional-exploratory-questions" id="toc-additional-exploratory-questions" class="nav-link" data-scroll-target="#additional-exploratory-questions">Additional Exploratory Questions</a>
  <ul class="collapse">
  <li><a href="#energy-vs.-valence-by-popularity" id="toc-energy-vs.-valence-by-popularity" class="nav-link" data-scroll-target="#energy-vs.-valence-by-popularity">Energy vs.&nbsp;Valence by Popularity</a></li>
  <li><a href="#acousticness-and-instrumentalness-over-time" id="toc-acousticness-and-instrumentalness-over-time" class="nav-link" data-scroll-target="#acousticness-and-instrumentalness-over-time">Acousticness and Instrumentalness Over Time</a></li>
  </ul></li>
  <li><a href="#building-a-playlist-from-anchor-songs" id="toc-building-a-playlist-from-anchor-songs" class="nav-link" data-scroll-target="#building-a-playlist-from-anchor-songs">Building a Playlist from Anchor Songs</a>
  <ul class="collapse">
  <li><a href="#heuristic-1-common-playlist-co-occurrences" id="toc-heuristic-1-common-playlist-co-occurrences" class="nav-link" data-scroll-target="#heuristic-1-common-playlist-co-occurrences">Heuristic 1: Common Playlist Co-occurrences</a></li>
  <li><a href="#heuristic-2-similar-key-and-tempo" id="toc-heuristic-2-similar-key-and-tempo" class="nav-link" data-scroll-target="#heuristic-2-similar-key-and-tempo">Heuristic 2: Similar Key and Tempo</a></li>
  <li><a href="#heuristic-3-same-artist" id="toc-heuristic-3-same-artist" class="nav-link" data-scroll-target="#heuristic-3-same-artist">Heuristic 3: Same Artist</a></li>
  <li><a href="#heuristic-4-similar-release-year-and-audio-features" id="toc-heuristic-4-similar-release-year-and-audio-features" class="nav-link" data-scroll-target="#heuristic-4-similar-release-year-and-audio-features">Heuristic 4: Similar Release Year and Audio Features</a></li>
  <li><a href="#heuristic-5-energy-progression-custom-heuristic" id="toc-heuristic-5-energy-progression-custom-heuristic" class="nav-link" data-scroll-target="#heuristic-5-energy-progression-custom-heuristic">Heuristic 5: Energy Progression (Custom Heuristic)</a></li>
  </ul></li>
  <li><a href="#combining-candidate-songs" id="toc-combining-candidate-songs" class="nav-link" data-scroll-target="#combining-candidate-songs">Combining Candidate Songs</a></li>
  <li><a href="#curating-the-ultimate-playlist" id="toc-curating-the-ultimate-playlist" class="nav-link" data-scroll-target="#curating-the-ultimate-playlist">Curating the Ultimate Playlist</a>
  <ul class="collapse">
  <li><a href="#visualizing-the-playlist-flow" id="toc-visualizing-the-playlist-flow" class="nav-link" data-scroll-target="#visualizing-the-playlist-flow">Visualizing the Playlist Flow</a></li>
  </ul></li>
  <li><a href="#the-ultimate-playlist-design-principles-and-analysis" id="toc-the-ultimate-playlist-design-principles-and-analysis" class="nav-link" data-scroll-target="#the-ultimate-playlist-design-principles-and-analysis">The Ultimate Playlist: Design Principles and Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA 9750 Mini-Project #03: Creating the Ultimate Playlist</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Faisal </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 16, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="the-science-of-flow-building-a-progressive-electronic-music-journey" class="level1">
<h1>The Science of Flow: Building a Progressive Electronic Music Journey</h1>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Music has the power to transport us, to alter our moods, and to create experiences that transcend the ordinary. In this analysis, I set out to create the ultimate electronic music playlist - one that takes listeners on a coherent journey while showcasing both popular tracks and hidden gems from the electronic music landscape.</p>
<p>By leveraging Spotify data on song characteristics and user-created playlists, I’ve employed data science techniques to build a playlist that follows a deliberate progression, starting with ambient atmospheric tracks, building through melodic house, peaking with energetic dance hits, and gradually descending to reflective closing tracks.</p>
<p>This analysis will demonstrate how musical elements like energy, danceability, tempo, and key can be analyzed to create a cohesive listening experience that feels natural and engaging from start to finish. I’ll walk through the data exploration process, identify patterns in popular electronic music, and show how I applied these insights to craft “Waveform: A Progressive Electronic Journey.”</p>
<section id="data-acquisition-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition-and-preparation">Data Acquisition and Preparation</h2>
<section id="song-characteristics-dataset" class="level3">
<h3 class="anchored" data-anchor-id="song-characteristics-dataset">Song Characteristics Dataset</h3>
<p>First, I created a function to download and load the Spotify song analytics dataset.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'jsonlite'

The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>load_songs <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  data_dir <span class="ot">&lt;-</span> <span class="st">"data/mp03"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(data_dir, <span class="st">"spotify_song_data.csv"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(data_dir)) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(data_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/gabminamedez/spotify-data/refs/heads/master/data.csv"</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Downloading song data..."</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(url, file_path, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Using cached song data file"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  song_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(file_path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(song_data)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>SONGS <span class="ot">&lt;-</span> <span class="fu">load_songs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using cached song data file</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>clean_artist_string <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(x, <span class="st">"</span><span class="sc">\\</span><span class="st">['"</span>, <span class="st">""</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">"'</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">""</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">" '"</span>, <span class="st">""</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>SONGS_CLEAN <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_longer_delim</span>(artists, <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">artist =</span> <span class="fu">clean_artist_string</span>(artists)) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>artists)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SONGS_CLEAN) <span class="sc">|&gt;</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Song Characteristics Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sample of Song Characteristics Dataset</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">duration_ms</th>
<th style="text-align: left;">release_date</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">acousticness</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">instrumentalness</th>
<th style="text-align: right;">liveness</th>
<th style="text-align: right;">loudness</th>
<th style="text-align: right;">speechiness</th>
<th style="text-align: right;">tempo</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">mode</th>
<th style="text-align: right;">key</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">explicit</th>
<th style="text-align: left;">artist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6KbQ3uYMLKb5jDxLF7wYDD</td>
<td style="text-align: left;">Singende Bataillone 1. Teil</td>
<td style="text-align: right;">158648</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">0.1950</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.1510</td>
<td style="text-align: right;">-12.428</td>
<td style="text-align: right;">0.0506</td>
<td style="text-align: right;">118.469</td>
<td style="text-align: right;">0.7790</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Carl Woitschach</td>
</tr>
<tr class="even">
<td style="text-align: left;">6KuQTIu1KoTTkLXKrwlLPV</td>
<td style="text-align: left;">Fantasiestücke, Op. 111: Più tosto lento</td>
<td style="text-align: right;">282133</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.994</td>
<td style="text-align: right;">0.379</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">0.0763</td>
<td style="text-align: right;">-28.454</td>
<td style="text-align: right;">0.0462</td>
<td style="text-align: right;">83.972</td>
<td style="text-align: right;">0.0767</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Robert Schumann’</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6KuQTIu1KoTTkLXKrwlLPV</td>
<td style="text-align: left;">Fantasiestücke, Op. 111: Più tosto lento</td>
<td style="text-align: right;">282133</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.994</td>
<td style="text-align: right;">0.379</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">0.0763</td>
<td style="text-align: right;">-28.454</td>
<td style="text-align: right;">0.0462</td>
<td style="text-align: right;">83.972</td>
<td style="text-align: right;">0.0767</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vladimir Horowitz</td>
</tr>
<tr class="even">
<td style="text-align: left;">6L63VW0PibdM1HDSBoqnoM</td>
<td style="text-align: left;">Chapter 1.18 - Zamek kaniowski</td>
<td style="text-align: right;">104300</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.749</td>
<td style="text-align: right;">0.2200</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.1190</td>
<td style="text-align: right;">-19.924</td>
<td style="text-align: right;">0.9290</td>
<td style="text-align: right;">107.177</td>
<td style="text-align: right;">0.8800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Seweryn Goszczyński</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6M94FkXd15sOAOQYRnWPN8</td>
<td style="text-align: left;">Bebamos Juntos - Instrumental (Remasterizado)</td>
<td style="text-align: right;">180760</td>
<td style="text-align: left;">9/25/28</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.1300</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.1110</td>
<td style="text-align: right;">-14.734</td>
<td style="text-align: right;">0.0926</td>
<td style="text-align: right;">108.003</td>
<td style="text-align: right;">0.7200</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Francisco Canaro</td>
</tr>
<tr class="even">
<td style="text-align: left;">6N6tiFZ9vLTSOIxkj8qKrd</td>
<td style="text-align: left;">Polonaise-Fantaisie in A-Flat Major, Op. 61</td>
<td style="text-align: right;">687733</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.2040</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">0.0980</td>
<td style="text-align: right;">-16.829</td>
<td style="text-align: right;">0.0424</td>
<td style="text-align: right;">62.149</td>
<td style="text-align: right;">0.0693</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Frédéric Chopin’</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The SONGS dataset contains r nrow(SONGS) songs with various audio features like tempo, danceability, energy, and key. These metrics will be crucial in building a cohesive playlist.</p>
</section>
</section>
<section id="playlist-dataset" class="level2">
<h2 class="anchored" data-anchor-id="playlist-dataset">Playlist Dataset</h2>
<p>Next, I created a function to load the Spotify Million Playlist dataset, which contains information about user-created playlists.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>load_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">max_files =</span> <span class="dv">5</span>) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  data_dir <span class="ot">&lt;-</span> <span class="st">"data/mp03/playlists"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(data_dir)) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(data_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  all_playlists <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  download_and_read_file <span class="ot">&lt;-</span> <span class="cf">function</span>(file_num) {</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    file_name <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"mpd.slice.%d-%d.json"</span>, (file_num <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">1000</span>, file_num <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(data_dir, file_name)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      url <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%s/%s"</span>, base_url, file_name)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Downloading"</span>, file_name, <span class="st">"..."</span>))</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tryCatch</span>({</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">download.file</span>(url, file_path, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Failed to download"</span>, file_name, <span class="st">":"</span>, e<span class="sc">$</span>message))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Using cached file:"</span>, file_name))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tryCatch</span>({</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(file_path)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(data<span class="sc">$</span>playlists)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Error reading"</span>, file_name, <span class="st">":"</span>, e<span class="sc">$</span>message))</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_files) {</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    playlist_data <span class="ot">&lt;-</span> <span class="fu">download_and_read_file</span>(i)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(playlist_data)) {</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>      all_playlists[[i]] <span class="ot">&lt;-</span> playlist_data</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(all_playlists)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>PLAYLISTS_RAW <span class="ot">&lt;-</span> <span class="fu">load_playlists</span>(<span class="at">max_files =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using cached file: mpd.slice.0-999.json</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using cached file: mpd.slice.1000-1999.json</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading mpd.slice.2000-2999.json ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in download.file(url, file_path, mode = "wb"): cannot open URL
'https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1/mpd.slice.2000-2999.json':
HTTP status was '404 Not Found'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Failed to download mpd.slice.2000-2999.json : cannot open URL 'https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1/mpd.slice.2000-2999.json'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using cached file: mpd.slice.3000-3999.json</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using cached file: mpd.slice.4000-4999.json</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Error reading mpd.slice.4000-4999.json : parse error: premature EOF
                                       
                     (right here) ------^</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>first_playlist <span class="ot">&lt;-</span> PLAYLISTS_RAW[[<span class="dv">1</span>]][<span class="dv">1</span>, ]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(first_playlist<span class="sc">$</span>tracks, <span class="at">max.level =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 1
 $ :'data.frame':   52 obs. of  8 variables:
  ..$ pos        : int [1:52] 0 1 2 3 4 5 6 7 8 9 ...
  ..$ artist_name: chr [1:52] "Missy Elliott" "Britney Spears" "Beyoncé" "Justin Timberlake" ...
  ..$ track_uri  : chr [1:52] "spotify:track:0UaMYEvWZi0ZqiDOoHU3YI" "spotify:track:6I9VzXrHxO9rA9A5euc8Ak" "spotify:track:0WqIKmW4BTrj3eJFmnCKMv" "spotify:track:1AWQoqb9bSvzTjaLralEkT" ...
  ..$ artist_uri : chr [1:52] "spotify:artist:2wIVse2owClT7go1WT98tk" "spotify:artist:26dSoYclwsYLMAKD3tpOr4" "spotify:artist:6vWDO969PvNqNYHIOW5v0m" "spotify:artist:31TPClRtHm23RisEBtV3X7" ...
  ..$ track_name : chr [1:52] "Lose Control (feat. Ciara &amp; Fat Man Scoop)" "Toxic" "Crazy In Love" "Rock Your Body" ...
  ..$ album_uri  : chr [1:52] "spotify:album:6vV5UrXcfyQD1wu4Qo2I9K" "spotify:album:0z7pVBGOD7HCIB7S8eLkLI" "spotify:album:25hVFAxTlDvXbx2X2QkUkE" "spotify:album:6QPkyl04rXwTGlGlcYaRoW" ...
  ..$ duration_ms: int [1:52] 226863 198800 235933 267266 227600 250373 223440 225560 271333 235213 ...
  ..$ album_name : chr [1:52] "The Cookbook" "In The Zone" "Dangerously In Love (Alben für die Ewigkeit)" "Justified" ...</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(first_playlist<span class="sc">$</span>tracks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  first_track <span class="ot">&lt;-</span> first_playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(first_track, <span class="at">max.level =</span> <span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   52 obs. of  8 variables:
 $ pos        : int  0 1 2 3 4 5 6 7 8 9 ...
 $ artist_name: chr  "Missy Elliott" "Britney Spears" "Beyoncé" "Justin Timberlake" ...
 $ track_uri  : chr  "spotify:track:0UaMYEvWZi0ZqiDOoHU3YI" "spotify:track:6I9VzXrHxO9rA9A5euc8Ak" "spotify:track:0WqIKmW4BTrj3eJFmnCKMv" "spotify:track:1AWQoqb9bSvzTjaLralEkT" ...
 $ artist_uri : chr  "spotify:artist:2wIVse2owClT7go1WT98tk" "spotify:artist:26dSoYclwsYLMAKD3tpOr4" "spotify:artist:6vWDO969PvNqNYHIOW5v0m" "spotify:artist:31TPClRtHm23RisEBtV3X7" ...
 $ track_name : chr  "Lose Control (feat. Ciara &amp; Fat Man Scoop)" "Toxic" "Crazy In Love" "Rock Your Body" ...
 $ album_uri  : chr  "spotify:album:6vV5UrXcfyQD1wu4Qo2I9K" "spotify:album:0z7pVBGOD7HCIB7S8eLkLI" "spotify:album:25hVFAxTlDvXbx2X2QkUkE" "spotify:album:6QPkyl04rXwTGlGlcYaRoW" ...
 $ duration_ms: int  226863 198800 235933 267266 227600 250373 223440 225560 271333 235213 ...
 $ album_name : chr  "The Cookbook" "In The Zone" "Dangerously In Love (Alben für die Ewigkeit)" "Justified" ...</code></pre>
</div>
</div>
<p>I’m using a subset of the Million Playlist Dataset to keep processing times manageable. This still gives us plenty of data to work with.</p>
</section>
<section id="converting-playlist-data-to-rectangular-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-playlist-data-to-rectangular-format">Converting Playlist Data to Rectangular Format</h2>
<p>Now I’ll convert the hierarchical playlist data into a rectangular format for easier analysis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>strip_spotify_prefix <span class="ot">&lt;-</span> <span class="cf">function</span>(uri) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(uri)) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  parts <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(uri, <span class="st">":"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(parts[<span class="fu">length</span>(parts)])</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>process_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>(playlists_df) {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  all_tracks <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(playlists_df)) {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    playlist_info <span class="ot">&lt;-</span> playlists_df[i, ]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    playlist_id <span class="ot">&lt;-</span> playlist_info<span class="sc">$</span>pid</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    playlist_name <span class="ot">&lt;-</span> playlist_info<span class="sc">$</span>name</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    playlist_followers <span class="ot">&lt;-</span> playlist_info<span class="sc">$</span>num_followers</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    tracks <span class="ot">&lt;-</span> playlist_info<span class="sc">$</span>tracks[[<span class="dv">1</span>]]</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(tracks) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    tracks_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tracks)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    tracks_df<span class="sc">$</span>playlist_id <span class="ot">&lt;-</span> playlist_id</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    tracks_df<span class="sc">$</span>playlist_name <span class="ot">&lt;-</span> playlist_name</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    tracks_df<span class="sc">$</span>playlist_followers <span class="ot">&lt;-</span> playlist_followers</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    tracks_df<span class="sc">$</span>playlist_position <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(tracks_df) <span class="sc">-</span> <span class="dv">1</span>)  </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="st">"artist_uri"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tracks_df)) {</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>      tracks_df<span class="sc">$</span>artist_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks_df<span class="sc">$</span>artist_uri, strip_spotify_prefix)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="st">"track_uri"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tracks_df)) {</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>      tracks_df<span class="sc">$</span>track_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks_df<span class="sc">$</span>track_uri, strip_spotify_prefix)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="st">"album_uri"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tracks_df)) {</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>      tracks_df<span class="sc">$</span>album_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks_df<span class="sc">$</span>album_uri, strip_spotify_prefix)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    cols_to_select <span class="ot">&lt;-</span> <span class="fu">intersect</span>(</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"playlist_name"</span>, <span class="st">"playlist_id"</span>, <span class="st">"playlist_position"</span>, <span class="st">"playlist_followers"</span>,</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artist_name"</span>, <span class="st">"artist_id"</span>, <span class="st">"track_name"</span>, <span class="st">"track_id"</span>, <span class="st">"album_name"</span>, <span class="st">"album_id"</span>, <span class="st">"duration_ms"</span>),</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(tracks_df)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    tracks_df <span class="ot">&lt;-</span> tracks_df[, cols_to_select]</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="st">"duration_ms"</span> <span class="sc">%in%</span> <span class="fu">names</span>(tracks_df)) {</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(tracks_df)[<span class="fu">names</span>(tracks_df) <span class="sc">==</span> <span class="st">"duration_ms"</span>] <span class="ot">&lt;-</span> <span class="st">"duration"</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    all_tracks <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_tracks, tracks_df)</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(all_tracks)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>PLAYLISTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(PLAYLISTS_RAW)) {</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  playlist_file <span class="ot">&lt;-</span> PLAYLISTS_RAW[[i]]</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(playlist_file)) {</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    processed_playlists <span class="ot">&lt;-</span> <span class="fu">process_playlists</span>(playlist_file)</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(processed_playlists) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>      PLAYLISTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(PLAYLISTS, processed_playlists)</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"Error processing file index"</span>, i, <span class="st">":"</span>, e<span class="sc">$</span>message))</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(PLAYLISTS) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(PLAYLISTS) <span class="sc">|&gt;</span> </span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Rectangular Playlist Data"</span>)</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No data was successfully processed."</span>)</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sample of Rectangular Playlist Data</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 9%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">playlist_name</th>
<th style="text-align: right;">playlist_id</th>
<th style="text-align: right;">playlist_position</th>
<th style="text-align: right;">playlist_followers</th>
<th style="text-align: left;">artist_name</th>
<th style="text-align: left;">artist_id</th>
<th style="text-align: left;">track_name</th>
<th style="text-align: left;">track_id</th>
<th style="text-align: left;">album_name</th>
<th style="text-align: left;">album_id</th>
<th style="text-align: right;">duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Missy Elliott</td>
<td style="text-align: left;">2wIVse2owClT7go1WT98tk</td>
<td style="text-align: left;">Lose Control (feat. Ciara &amp; Fat Man Scoop)</td>
<td style="text-align: left;">0UaMYEvWZi0ZqiDOoHU3YI</td>
<td style="text-align: left;">The Cookbook</td>
<td style="text-align: left;">6vV5UrXcfyQD1wu4Qo2I9K</td>
<td style="text-align: right;">226863</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Britney Spears</td>
<td style="text-align: left;">26dSoYclwsYLMAKD3tpOr4</td>
<td style="text-align: left;">Toxic</td>
<td style="text-align: left;">6I9VzXrHxO9rA9A5euc8Ak</td>
<td style="text-align: left;">In The Zone</td>
<td style="text-align: left;">0z7pVBGOD7HCIB7S8eLkLI</td>
<td style="text-align: right;">198800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Beyoncé</td>
<td style="text-align: left;">6vWDO969PvNqNYHIOW5v0m</td>
<td style="text-align: left;">Crazy In Love</td>
<td style="text-align: left;">0WqIKmW4BTrj3eJFmnCKMv</td>
<td style="text-align: left;">Dangerously In Love (Alben für die Ewigkeit)</td>
<td style="text-align: left;">25hVFAxTlDvXbx2X2QkUkE</td>
<td style="text-align: right;">235933</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Justin Timberlake</td>
<td style="text-align: left;">31TPClRtHm23RisEBtV3X7</td>
<td style="text-align: left;">Rock Your Body</td>
<td style="text-align: left;">1AWQoqb9bSvzTjaLralEkT</td>
<td style="text-align: left;">Justified</td>
<td style="text-align: left;">6QPkyl04rXwTGlGlcYaRoW</td>
<td style="text-align: right;">267266</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Shaggy</td>
<td style="text-align: left;">5EvFsr3kj42KNv97ZEnqij</td>
<td style="text-align: left;">It Wasn’t Me</td>
<td style="text-align: left;">1lzr43nnXAijIGYnCT8M8H</td>
<td style="text-align: left;">Hot Shot</td>
<td style="text-align: left;">6NmFmPX56pcLBOFMhIiKvF</td>
<td style="text-align: right;">227600</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: left;">23zg3TcAtWQy7J6upgbUnj</td>
<td style="text-align: left;">Yeah!</td>
<td style="text-align: left;">0XUfyU2QviPAs6bxSpXYG4</td>
<td style="text-align: left;">Confessions</td>
<td style="text-align: left;">0vO0b1AvY49CPQyVisJLj0</td>
<td style="text-align: right;">250373</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of elements in PLAYLISTS_RAW:"</span>, <span class="fu">length</span>(PLAYLISTS_RAW), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of elements in PLAYLISTS_RAW: 4 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Types of each element:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Types of each element:</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(PLAYLISTS_RAW)) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Element"</span>, i, <span class="st">"is a"</span>, <span class="fu">class</span>(PLAYLISTS_RAW[[i]]), </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">"with dimensions"</span>, <span class="fu">ifelse</span>(<span class="fu">is.data.frame</span>(PLAYLISTS_RAW[[i]]), </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">paste</span>(<span class="fu">dim</span>(PLAYLISTS_RAW[[i]]), <span class="at">collapse=</span><span class="st">"×"</span>), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"N/A"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Element 1 is a data.frame with dimensions 1000×12 
Element 2 is a data.frame with dimensions 1000×12 
Element 3 is a NULL with dimensions N/A 
Element 4 is a data.frame with dimensions 1000×12 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>PLAYLISTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">playlist_name =</span> <span class="fu">character</span>(),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">playlist_id =</span> <span class="fu">integer</span>(),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">playlist_position =</span> <span class="fu">integer</span>(),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">playlist_followers =</span> <span class="fu">integer</span>(),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">artist_name =</span> <span class="fu">character</span>(),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">artist_id =</span> <span class="fu">character</span>(),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">track_name =</span> <span class="fu">character</span>(),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">track_id =</span> <span class="fu">character</span>(),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">album_name =</span> <span class="fu">character</span>(), </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">album_id =</span> <span class="fu">character</span>(),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">duration =</span> <span class="fu">integer</span>(),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file_idx <span class="cf">in</span> <span class="fu">seq_along</span>(PLAYLISTS_RAW)) {</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  playlist_file <span class="ot">&lt;-</span> PLAYLISTS_RAW[[file_idx]]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(playlist_file)) {</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Skipping NULL element"</span>, file_idx, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">next</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Processing file"</span>, file_idx, <span class="st">"with"</span>, <span class="fu">nrow</span>(playlist_file), <span class="st">"playlists</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">10</span>, <span class="fu">nrow</span>(playlist_file))) {</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      playlist <span class="ot">&lt;-</span> playlist_file[i, ]</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"First playlist track structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">is.list</span>(playlist<span class="sc">$</span>tracks)) {</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Tracks is a list with"</span>, <span class="fu">length</span>(playlist<span class="sc">$</span>tracks), <span class="st">"elements</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">length</span>(playlist<span class="sc">$</span>tracks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">"First track element class:"</span>, <span class="fu">class</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]]), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">is.data.frame</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]])) {</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>              <span class="fu">cat</span>(<span class="st">"Track dataframe dimensions:"</span>, <span class="fu">paste</span>(<span class="fu">dim</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]]), <span class="at">collapse=</span><span class="st">"×"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">cat</span>(<span class="st">"Track columns:"</span>, <span class="fu">paste</span>(<span class="fu">colnames</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]]), <span class="at">collapse=</span><span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>              <span class="fu">str</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]], <span class="at">max.level=</span><span class="dv">1</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cat</span>(<span class="st">"Tracks is not a list but a"</span>, <span class="fu">class</span>(playlist<span class="sc">$</span>tracks), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>      tracks <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.list</span>(playlist<span class="sc">$</span>tracks)) {</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(playlist<span class="sc">$</span>tracks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">is.data.frame</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]])) {</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>            tracks <span class="ot">&lt;-</span> playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]]</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>            tracks <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(playlist<span class="sc">$</span>tracks[[<span class="dv">1</span>]], <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.null</span>(tracks) <span class="sc">||</span> <span class="fu">nrow</span>(tracks) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"No valid tracks for playlist"</span>, i, <span class="st">"in file"</span>, file_idx, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>      playlist_tracks <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">playlist_name =</span> <span class="fu">rep</span>(playlist<span class="sc">$</span>name, <span class="fu">nrow</span>(tracks)),</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">playlist_id =</span> <span class="fu">rep</span>(playlist<span class="sc">$</span>pid, <span class="fu">nrow</span>(tracks)),</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">playlist_position =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">nrow</span>(tracks) <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">playlist_followers =</span> <span class="fu">rep</span>(playlist<span class="sc">$</span>num_followers, <span class="fu">nrow</span>(tracks)),</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"artist_name"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>artist_name <span class="ot">&lt;-</span> tracks<span class="sc">$</span>artist_name</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>artist_name <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"artist_uri"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>artist_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks<span class="sc">$</span>artist_uri, <span class="cf">function</span>(x) {</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tryCatch</span>(<span class="fu">strip_spotify_prefix</span>(x), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA_character_</span>)</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>artist_id <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"track_name"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>track_name <span class="ot">&lt;-</span> tracks<span class="sc">$</span>track_name</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>track_name <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"track_uri"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>track_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks<span class="sc">$</span>track_uri, <span class="cf">function</span>(x) {</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tryCatch</span>(<span class="fu">strip_spotify_prefix</span>(x), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA_character_</span>)</span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>track_id <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"album_name"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>album_name <span class="ot">&lt;-</span> tracks<span class="sc">$</span>album_name</span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>album_name <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"album_uri"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>album_id <span class="ot">&lt;-</span> <span class="fu">sapply</span>(tracks<span class="sc">$</span>album_uri, <span class="cf">function</span>(x) {</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tryCatch</span>(<span class="fu">strip_spotify_prefix</span>(x), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NA_character_</span>)</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>album_id <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"duration_ms"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(tracks)) {</span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>duration <span class="ot">&lt;-</span> tracks<span class="sc">$</span>duration_ms</span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>        playlist_tracks<span class="sc">$</span>duration <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a>      PLAYLISTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(PLAYLISTS, playlist_tracks)</span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Added"</span>, <span class="fu">nrow</span>(playlist_tracks), <span class="st">"tracks from playlist"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Error processing playlist"</span>, i, <span class="st">"in file"</span>, file_idx, <span class="st">":"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Processing file 1 with 1000 playlists
First playlist track structure:
Tracks is a list with 1 elements
First track element class: data.frame 
Track dataframe dimensions: 52×8 
Track columns: pos, artist_name, track_uri, artist_uri, track_name, album_uri, duration_ms, album_name 
Added 52 tracks from playlist 1 
Added 39 tracks from playlist 2 
Added 64 tracks from playlist 3 
Added 126 tracks from playlist 4 
Added 17 tracks from playlist 5 
Added 80 tracks from playlist 6 
Added 16 tracks from playlist 7 
Added 53 tracks from playlist 8 
Added 46 tracks from playlist 9 
Added 21 tracks from playlist 10 
Processing file 2 with 1000 playlists
First playlist track structure:
Tracks is a list with 1 elements
First track element class: data.frame 
Track dataframe dimensions: 189×8 
Track columns: pos, artist_name, track_uri, artist_uri, track_name, album_uri, duration_ms, album_name 
Added 189 tracks from playlist 1 
Added 165 tracks from playlist 2 
Added 17 tracks from playlist 3 
Added 225 tracks from playlist 4 
Added 165 tracks from playlist 5 
Added 28 tracks from playlist 6 
Added 80 tracks from playlist 7 
Added 58 tracks from playlist 8 
Added 84 tracks from playlist 9 
Added 41 tracks from playlist 10 
Skipping NULL element 3 
Processing file 4 with 1000 playlists
First playlist track structure:
Tracks is a list with 1 elements
First track element class: data.frame 
Track dataframe dimensions: 16×8 
Track columns: pos, artist_name, track_uri, artist_uri, track_name, album_uri, duration_ms, album_name 
Added 16 tracks from playlist 1 
Added 26 tracks from playlist 2 
Added 12 tracks from playlist 3 
Added 245 tracks from playlist 4 
Added 53 tracks from playlist 5 
Added 81 tracks from playlist 6 
Added 56 tracks from playlist 7 
Added 71 tracks from playlist 8 
Added 11 tracks from playlist 9 
Added 11 tracks from playlist 10 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(PLAYLISTS) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Successfully processed"</span>, <span class="fu">nrow</span>(PLAYLISTS), <span class="st">"tracks</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(PLAYLISTS) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Rectangular Playlist Data"</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No data was successfully processed.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Successfully processed 2148 tracks</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sample of Rectangular Playlist Data</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 9%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">playlist_name</th>
<th style="text-align: right;">playlist_id</th>
<th style="text-align: right;">playlist_position</th>
<th style="text-align: right;">playlist_followers</th>
<th style="text-align: left;">artist_name</th>
<th style="text-align: left;">artist_id</th>
<th style="text-align: left;">track_name</th>
<th style="text-align: left;">track_id</th>
<th style="text-align: left;">album_name</th>
<th style="text-align: left;">album_id</th>
<th style="text-align: right;">duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Missy Elliott</td>
<td style="text-align: left;">2wIVse2owClT7go1WT98tk</td>
<td style="text-align: left;">Lose Control (feat. Ciara &amp; Fat Man Scoop)</td>
<td style="text-align: left;">0UaMYEvWZi0ZqiDOoHU3YI</td>
<td style="text-align: left;">The Cookbook</td>
<td style="text-align: left;">6vV5UrXcfyQD1wu4Qo2I9K</td>
<td style="text-align: right;">226863</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Britney Spears</td>
<td style="text-align: left;">26dSoYclwsYLMAKD3tpOr4</td>
<td style="text-align: left;">Toxic</td>
<td style="text-align: left;">6I9VzXrHxO9rA9A5euc8Ak</td>
<td style="text-align: left;">In The Zone</td>
<td style="text-align: left;">0z7pVBGOD7HCIB7S8eLkLI</td>
<td style="text-align: right;">198800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Beyoncé</td>
<td style="text-align: left;">6vWDO969PvNqNYHIOW5v0m</td>
<td style="text-align: left;">Crazy In Love</td>
<td style="text-align: left;">0WqIKmW4BTrj3eJFmnCKMv</td>
<td style="text-align: left;">Dangerously In Love (Alben für die Ewigkeit)</td>
<td style="text-align: left;">25hVFAxTlDvXbx2X2QkUkE</td>
<td style="text-align: right;">235933</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Justin Timberlake</td>
<td style="text-align: left;">31TPClRtHm23RisEBtV3X7</td>
<td style="text-align: left;">Rock Your Body</td>
<td style="text-align: left;">1AWQoqb9bSvzTjaLralEkT</td>
<td style="text-align: left;">Justified</td>
<td style="text-align: left;">6QPkyl04rXwTGlGlcYaRoW</td>
<td style="text-align: right;">267266</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Shaggy</td>
<td style="text-align: left;">5EvFsr3kj42KNv97ZEnqij</td>
<td style="text-align: left;">It Wasn’t Me</td>
<td style="text-align: left;">1lzr43nnXAijIGYnCT8M8H</td>
<td style="text-align: left;">Hot Shot</td>
<td style="text-align: left;">6NmFmPX56pcLBOFMhIiKvF</td>
<td style="text-align: right;">227600</td>
</tr>
<tr class="even">
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: left;">23zg3TcAtWQy7J6upgbUnj</td>
<td style="text-align: left;">Yeah!</td>
<td style="text-align: left;">0XUfyU2QviPAs6bxSpXYG4</td>
<td style="text-align: left;">Confessions</td>
<td style="text-align: left;">0vO0b1AvY49CPQyVisJLj0</td>
<td style="text-align: right;">250373</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The rectangular format makes it much easier to analyze how songs are used across different playlists. Each row represents a single track placement within a playlist.</p>
</section>
<section id="initial-exploration" class="level2">
<h2 class="anchored" data-anchor-id="initial-exploration">Initial Exploration</h2>
<p>Now that I have both datasets properly formatted, I’ll explore them to understand what kind of music is available and popular on Spotify.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. How many distinct tracks and artists are in the playlist data?</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>distinct_tracks <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(PLAYLISTS<span class="sc">$</span>track_id)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>distinct_artists <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(PLAYLISTS<span class="sc">$</span>artist_id)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>distinct_counts_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Distinct Tracks"</span>, <span class="st">"Distinct Artists"</span>),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Count =</span> <span class="fu">c</span>(distinct_tracks, distinct_artists)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(distinct_counts_df, <span class="at">caption =</span> <span class="st">"Distinct Counts in Playlist Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Distinct Counts in Playlist Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: right;">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Distinct Tracks</td>
<td style="text-align: right;">2057</td>
</tr>
<tr class="even">
<td style="text-align: left;">Distinct Artists</td>
<td style="text-align: right;">1104</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. What are the 5 most popular tracks in the playlist data?</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>top_tracks <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(track_id, track_name, artist_name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(top_tracks, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track ID"</span>, <span class="st">"Track Name"</span>, <span class="st">"Artist"</span>, <span class="st">"Playlist Appearances"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 24%">
<col style="width: 21%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Track ID</th>
<th style="text-align: left;">Track Name</th>
<th style="text-align: left;">Artist</th>
<th style="text-align: right;">Playlist Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0OgkJWoRL7Kqr8nqfBrV5C</td>
<td style="text-align: left;">Monsters</td>
<td style="text-align: left;">Conner Youngblood</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">41yIvlFgvGwxq8qTqAR7eG</td>
<td style="text-align: left;">Bloom - Bonus Track</td>
<td style="text-align: left;">The Paper Kites</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5GXAXm5YOmYT0kL5jHvYBt</td>
<td style="text-align: left;">I Feel It Coming</td>
<td style="text-align: left;">The Weeknd</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">5tz69p7tJuGPeMGwNTxYuV</td>
<td style="text-align: left;">1-800-273-8255</td>
<td style="text-align: left;">Logic</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">68vgtRHr7iZHpzGpon6Jlo</td>
<td style="text-align: left;">My Boo</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Most popular track without song characteristics data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>missing_tracks <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  PLAYLISTS <span class="sc">|&gt;</span> <span class="fu">select</span>(track_id, track_name, artist_name),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  SONGS <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">track_id =</span> id) <span class="sc">|&gt;</span> <span class="fu">select</span>(track_id),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"track_id"</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(track_id, track_name, artist_name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(missing_tracks, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track ID"</span>, <span class="st">"Track Name"</span>, <span class="st">"Artist"</span>, <span class="st">"Playlist Appearances"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 15%">
<col style="width: 24%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Track ID</th>
<th style="text-align: left;">Track Name</th>
<th style="text-align: left;">Artist</th>
<th style="text-align: right;">Playlist Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0OgkJWoRL7Kqr8nqfBrV5C</td>
<td style="text-align: left;">Monsters</td>
<td style="text-align: left;">Conner Youngblood</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. What is the most danceable track?</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>most_danceable <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(danceability)) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, danceability) <span class="sc">|&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># How often does it appear in playlists?</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>most_danceable_appearances <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(track_id <span class="sc">==</span> most_danceable<span class="sc">$</span>id) <span class="sc">|&gt;</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">|&gt;</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>most_danceable_info <span class="ot">&lt;-</span> most_danceable <span class="sc">|&gt;</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">playlist_appearances =</span> most_danceable_appearances)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(most_danceable_info, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track ID"</span>, <span class="st">"Track Name"</span>, <span class="st">"Danceability"</span>, <span class="st">"Playlist Appearances"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 24%">
<col style="width: 17%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Track ID</th>
<th style="text-align: left;">Track Name</th>
<th style="text-align: right;">Danceability</th>
<th style="text-align: right;">Playlist Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5YIF6HSOtHN9HdcE5IPzMe</td>
<td style="text-align: left;">Funky Cold Medina</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Which playlist has the longest average track length?</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>longest_avg_playlist <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(playlist_id, playlist_name) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_length_ms =</span> <span class="fu">mean</span>(duration),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">track_count =</span> <span class="fu">n</span>(),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(track_count <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span>  <span class="co"># Filter out very small playlists</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_length_ms)) <span class="sc">|&gt;</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_length_min =</span> avg_length_ms <span class="sc">/</span> (<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">60</span>))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(longest_avg_playlist <span class="sc">|&gt;</span> <span class="fu">select</span>(playlist_id, playlist_name, avg_length_min, track_count),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Playlist ID"</span>, <span class="st">"Playlist Name"</span>, <span class="st">"Avg. Length (minutes)"</span>, <span class="st">"Track Count"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Playlist ID</th>
<th style="text-align: left;">Playlist Name</th>
<th style="text-align: right;">Avg. Length (minutes)</th>
<th style="text-align: right;">Track Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Awesome Playlist</td>
<td style="text-align: right;">4.981397</td>
<td style="text-align: right;">39</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. What is the most popular playlist on Spotify?</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>most_popular_playlist <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playlist_id, playlist_name, playlist_followers) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(playlist_followers)) <span class="sc">|&gt;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(most_popular_playlist, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Playlist ID"</span>, <span class="st">"Playlist Name"</span>, <span class="st">"Followers"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Playlist ID</th>
<th style="text-align: left;">Playlist Name</th>
<th style="text-align: right;">Followers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1008</td>
<td style="text-align: left;">Now</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="key-findings-from-initial-exploration" class="level3">
<h3 class="anchored" data-anchor-id="key-findings-from-initial-exploration">Key Findings from Initial Exploration:</h3>
<ul>
<li><p>The playlist dataset contains r distinct_counts[[1]] distinct tracks and r distinct_counts[[2]] distinct artists.</p></li>
<li><p>The most popular track in our dataset is “r top_tracks<span class="math inline">\(track_name[1]" by r top_tracks\)</span>artist_name[1], appearing in r top_tracks$n[1] playlists.</p></li>
<li><p>The most danceable track is “r most_danceable<span class="math inline">\(name" with a danceability score of r most_danceable\)</span>danceability. It appears in r most_danceable_appearances playlists in our dataset.</p></li>
<li><p>The playlist with the longest average track length is “r longest_avg_playlist<span class="math inline">\(playlist_name" with tracks averaging r round(longest_avg_playlist\)</span>avg_length_min, 2) minutes.</p></li>
<li><p>The most popular playlist is “r most_popular_playlist<span class="math inline">\(playlist_name" with r most_popular_playlist\)</span>playlist_followers followers.</p></li>
<li><p>These initial findings help establish a baseline understanding of the Spotify ecosystem. Next, I’ll combine the datasets and dive deeper into the characteristics of popular songs.</p></li>
</ul>
</section>
</section>
<section id="identifying-characteristics-of-popular-songs" class="level2">
<h2 class="anchored" data-anchor-id="identifying-characteristics-of-popular-songs">Identifying Characteristics of Popular Songs</h2>
<p>Let’s join the playlist and song characteristic datasets to explore what makes certain songs popular.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>COMBINED <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(SONGS <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">track_id =</span> id) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id), <span class="at">by =</span> <span class="st">"track_id"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>TRACK_POPULARITY <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(track_id, name, year, popularity) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">playlist_appearances =</span> n)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(COMBINED <span class="sc">|&gt;</span> <span class="fu">select</span>(track_name, artist_name, year, popularity, danceability, energy)) <span class="sc">|&gt;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Combined Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Sample of Combined Dataset</caption>
<colgroup>
<col style="width: 43%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">track_name</th>
<th style="text-align: left;">artist_name</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lose Control (feat. Ciara &amp; Fat Man Scoop)</td>
<td style="text-align: left;">Missy Elliott</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0.904</td>
<td style="text-align: right;">0.813</td>
</tr>
<tr class="even">
<td style="text-align: left;">Toxic</td>
<td style="text-align: left;">Britney Spears</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rock Your Body</td>
<td style="text-align: left;">Justin Timberlake</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.714</td>
</tr>
<tr class="even">
<td style="text-align: left;">My Boo</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.507</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Buttons</td>
<td style="text-align: left;">The Pussycat Dolls</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.821</td>
</tr>
<tr class="even">
<td style="text-align: left;">Say My Name</td>
<td style="text-align: left;">Destiny’s Child</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0.713</td>
<td style="text-align: right;">0.678</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now I’ll explore the characteristics of popular songs through visualizations.</p>
</section>
<section id="correlation-between-spotify-popularity-and-playlist-appearances" class="level2">
<h2 class="anchored" data-anchor-id="correlation-between-spotify-popularity-and-playlist-appearances">Correlation Between Spotify Popularity and Playlist Appearances</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>popularity_threshold <span class="ot">&lt;-</span> <span class="dv">75</span>  </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(TRACK_POPULARITY, <span class="fu">aes</span>(<span class="at">x =</span> popularity, <span class="at">y =</span> playlist_appearances)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> popularity <span class="sc">&gt;=</span> popularity_threshold), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"#1DB954"</span>), </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Less Popular"</span>, <span class="st">"Popular"</span>)) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship Between Spotify Popularity and Playlist Appearances"</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Popularity threshold:"</span>, popularity_threshold),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Spotify Popularity Score"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Playlist Appearances"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Popularity Category"</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The correlation between Spotify’s popularity score and the number of playlist appearances is r round(popularity_cor, 2). This positive correlation indicates that songs with higher popularity scores tend to appear in more playlists, which is expected. However, the moderate strength of this correlation suggests that playlist creators don’t just rely on popularity - other factors influence their selections.</p>
</section>
<section id="popular-songs-by-release-year" class="level2">
<h2 class="anchored" data-anchor-id="popular-songs-by-release-year">Popular Songs by Release Year</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>popular_by_year <span class="ot">&lt;-</span> TRACK_POPULARITY <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;=</span> popularity_threshold) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1920</span>, year <span class="sc">&lt;=</span> <span class="dv">2023</span>)  <span class="co"># Filter out potential outliers</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(popular_by_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> avg_popularity), <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"#1DB954"</span>) <span class="sc">+</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> popular_by_year <span class="sc">|&gt;</span> <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="fu">max</span>(popular_by_year<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">0.7</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> year),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Number of Popular Songs by Release Year"</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Songs with popularity score ≥"</span>, popularity_threshold),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Release Year"</span>,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Popular Songs"</span>,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Avg. Popularity Score"</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>peak_year <span class="ot">&lt;-</span> popular_by_year <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count)) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the distribution of popular songs by release year, we can see that r peak_year<span class="math inline">\(year had the highest number of popular songs with r peak_year\)</span>count tracks. This suggests a sweet spot where these songs are recent enough to remain culturally relevant but have had sufficient time to accumulate playlist appearances.</p>
</section>
<section id="danceability-over-time" class="level2">
<h2 class="anchored" data-anchor-id="danceability-over-time">Danceability Over Time</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>danceability_by_year <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_danceability =</span> <span class="fu">mean</span>(danceability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1920</span>, year <span class="sc">&lt;=</span> <span class="dv">2023</span>, count <span class="sc">&gt;</span> <span class="dv">5</span>)  <span class="co"># Filter for reliable averages</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(danceability_by_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_danceability)) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#1DB954"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> count), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#1DB954"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Danceability of Songs by Release Year"</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Larger points indicate more songs from that year"</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Release Year"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Danceability"</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">"Number of Songs"</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>peak_danceability_year <span class="ot">&lt;-</span> danceability_by_year <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_danceability)) <span class="sc">|&gt;</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Danceability peaked in the year r peak_danceability_year<span class="math inline">\(year with an average score of r round(peak_danceability_year\)</span>avg_danceability, 3). The overall trend shows that music has become progressively more danceable over the decades, with a particularly sharp increase starting in the 1980s and continuing through the early 2000s.</p>
</section>
<section id="decade-representation-in-playlists" class="level2">
<h2 class="anchored" data-anchor-id="decade-representation-in-playlists">Decade Representation in Playlists</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>COMBINED <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> (year <span class="sc">%/%</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>decade_representation <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">track_count =</span> <span class="fu">n_distinct</span>(track_id),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">playlist_appearances =</span> <span class="fu">n</span>(),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(decade <span class="sc">&gt;=</span> <span class="dv">1920</span>, decade <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade_label =</span> <span class="fu">paste0</span>(decade, <span class="st">"s"</span>))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>decade_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decade_representation) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> decade_label, <span class="at">y =</span> track_count, <span class="at">fill =</span> <span class="st">"Unique Tracks"</span>)) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> decade_label, <span class="at">y =</span> playlist_appearances<span class="sc">/</span><span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"Playlist Appearances (÷10)"</span>)) <span class="sc">+</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Unique Tracks"</span> <span class="ot">=</span> <span class="st">"#1DB954"</span>, <span class="st">"Playlist Appearances (÷10)"</span> <span class="ot">=</span> <span class="st">"#1E90FF"</span>)) <span class="sc">+</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Music Representation by Decade in Spotify Playlists"</span>,</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Measure"</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(decade_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>most_represented_decade <span class="ot">&lt;-</span> decade_representation <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(playlist_appearances)) <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The r most_represented_decade<span class="math inline">\(decade_label are the most represented in our playlist data, with r most_represented_decade\)</span>track_count unique tracks appearing a total of r most_represented_decade$playlist_appearances times. This suggests that songs from this era have enduring popularity among playlist creators.</p>
</section>
<section id="musical-key-distribution" class="level2">
<h2 class="anchored" data-anchor-id="musical-key-distribution">Musical Key Distribution</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>key_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"C♯/D♭"</span>, <span class="st">"D"</span>, <span class="st">"D♯/E♭"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"F♯/G♭"</span>, <span class="st">"G"</span>, <span class="st">"G♯/A♭"</span>, <span class="st">"A"</span>, <span class="st">"A♯/B♭"</span>, <span class="st">"B"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>key_distribution <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">key_name =</span> key_names[key <span class="sc">+</span> <span class="dv">1</span>]) <span class="sc">|&gt;</span>  <span class="co"># +1 because R is 1-indexed</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(key, key_name, mode) <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_popularity =</span> <span class="fu">mean</span>(popularity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode_label =</span> <span class="fu">ifelse</span>(mode <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Major"</span>, <span class="st">"Minor"</span>),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">key_mode =</span> <span class="fu">paste</span>(key_name, mode_label)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(key_distribution, <span class="fu">aes</span>(<span class="at">x =</span> key_name, <span class="at">y =</span> count, <span class="at">fill =</span> mode_label)) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Major"</span> <span class="ot">=</span> <span class="st">"#1DB954"</span>, <span class="st">"Minor"</span> <span class="ot">=</span> <span class="st">"#1E90FF"</span>)) <span class="sc">+</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Songs by Musical Key"</span>,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Displayed in circle of fifths arrangement"</span>,</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Mode"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Songs"</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>C major and its relative minor (A minor) appear to be the most common keys, which aligns with general music theory principles. The circular representation helps visualize the relationship between keys in the circle of fifths, which will be useful when building a playlist that transitions smoothly between songs.</p>
</section>
<section id="popular-track-lengths" class="level2">
<h2 class="anchored" data-anchor-id="popular-track-lengths">Popular Track Lengths</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>COMBINED <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration_min =</span> duration <span class="sc">/</span> (<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">60</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>sum_na <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(COMBINED<span class="sc">$</span>duration_min))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Number of NA values in duration_min:"</span>, sum_na))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Number of NA values in duration_min: 0"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>COMBINED_filtered <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(duration_min)) </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>median_duration <span class="ot">&lt;-</span> <span class="fu">median</span>(COMBINED_filtered<span class="sc">$</span>duration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>max_bincount <span class="ot">&lt;-</span> COMBINED_filtered <span class="sc">|&gt;</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">cut</span>(duration_min, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.25</span>))) <span class="sc">|&gt;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(COMBINED_filtered, <span class="fu">aes</span>(<span class="at">x =</span> duration_min)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> popularity <span class="sc">&gt;=</span> popularity_threshold), </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray60"</span>, <span class="st">"#1DB954"</span>), </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Less Popular"</span>, <span class="st">"Popular"</span>)) <span class="sc">+</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> median_duration, </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> median_duration <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> max_bincount <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Median:"</span>, <span class="fu">round</span>(median_duration, <span class="dv">2</span>), <span class="st">"min"</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Track Lengths in Spotify Playlists"</span>,</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Popular vs. Less Popular Songs"</span>,</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Length (minutes)"</span>,</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Popularity"</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The most common track length falls between 3-4 minutes, with popular songs clustering tightly around this range. This represents an industry standard length optimized for radio play and listener attention spans. Interestingly, there’s a noticeable drop-off in popularity for songs longer than 5 minutes.</p>
</section>
<section id="additional-exploratory-questions" class="level2">
<h2 class="anchored" data-anchor-id="additional-exploratory-questions">Additional Exploratory Questions</h2>
<section id="energy-vs.-valence-by-popularity" class="level3">
<h3 class="anchored" data-anchor-id="energy-vs.-valence-by-popularity">Energy vs.&nbsp;Valence by Popularity</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(COMBINED, <span class="fu">aes</span>(<span class="at">x =</span> energy, <span class="at">y =</span> valence)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> COMBINED <span class="sc">|&gt;</span> <span class="fu">filter</span>(popularity <span class="sc">&gt;=</span> <span class="dv">85</span>), </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#1DB954"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"navy"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Energy vs. Valence in Spotify Songs"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Hexbin density plot with highly popular songs (popularity ≥ 85) highlighted in green"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Energy"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Valence (Positivity)"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Song Count"</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(u)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>This visualization reveals the relationship between a song’s energy (intensity and activity) and valence (musical positivity). Highly popular songs (green dots) are distributed throughout the energy-valence space, but we can observe a slight clustering in the high-energy, medium-valence region. This suggests that energetic songs with moderate emotional positivity tend to perform well.</p>
</section>
<section id="acousticness-and-instrumentalness-over-time" class="level3">
<h3 class="anchored" data-anchor-id="acousticness-and-instrumentalness-over-time">Acousticness and Instrumentalness Over Time</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>acoustic_instrumental_trends <span class="ot">&lt;-</span> COMBINED <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(decade <span class="sc">&gt;=</span> <span class="dv">1920</span>, decade <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_acousticness =</span> <span class="fu">mean</span>(acousticness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_instrumentalness =</span> <span class="fu">mean</span>(instrumentalness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(avg_acousticness, avg_instrumentalness),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"feature"</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>      feature <span class="sc">==</span> <span class="st">"avg_acousticness"</span> <span class="sc">~</span> <span class="st">"Acousticness"</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>      feature <span class="sc">==</span> <span class="st">"avg_instrumentalness"</span> <span class="sc">~</span> <span class="st">"Instrumentalness"</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">decade_label =</span> <span class="fu">paste0</span>(decade, <span class="st">"s"</span>)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(acoustic_instrumental_trends, <span class="fu">aes</span>(<span class="at">x =</span> decade_label, <span class="at">y =</span> value, <span class="at">color =</span> feature_name, <span class="at">group =</span> feature_name)) <span class="sc">+</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Acousticness"</span> <span class="ot">=</span> <span class="st">"#1DB954"</span>, <span class="st">"Instrumentalness"</span> <span class="ot">=</span> <span class="st">"#1E90FF"</span>)) <span class="sc">+</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trends in Acousticness and Instrumentalness Over Decades"</span>,</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Value"</span>,</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Feature"</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows a clear historical trend: both acousticness and instrumentalness have declined dramatically over time, reflecting the evolution from acoustic instruments to electronic production techniques. The steady drop in acousticness since the 1960s coincides with the rise of electric instruments and studio production techniques. The steeper drop in instrumentalness indicates a growing emphasis on vocals in popular music.</p>
</section>
</section>
<section id="building-a-playlist-from-anchor-songs" class="level2">
<h2 class="anchored" data-anchor-id="building-a-playlist-from-anchor-songs">Building a Playlist from Anchor Songs</h2>
<p>For my ultimate playlist, I’ve chosen to focus on electronic music with a progressive energy flow. I’ll start with two anchor songs:</p>
<ol type="1">
<li>“Strobe” by Deadmau5 - A progressive house classic that builds slowly</li>
<li>“Opus” by Eric Prydz - An epic journey track with a gradual build Let’s find songs that would work well with these anchors using different heuristics.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>anchor_songs <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    (name <span class="sc">==</span> <span class="st">"Strobe"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(artists, <span class="st">"deadmau5"</span>)) <span class="sc">|</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    (name <span class="sc">==</span> <span class="st">"Opus"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(artists, <span class="st">"Eric Prydz"</span>))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(anchor_songs) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  anchor_songs <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>      (genre <span class="sc">==</span> <span class="st">"electronic"</span> <span class="sc">|</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">str_detect</span>(artists, <span class="st">"Deadmau5|Eric Prydz|Daft Punk|Avicii"</span>)) <span class="sc">&amp;</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        danceability <span class="sc">&gt;</span> <span class="fl">0.6</span> <span class="sc">&amp;</span> </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        energy <span class="sc">&gt;</span> <span class="fl">0.7</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(popularity, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(anchor_songs <span class="sc">|&gt;</span> </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(name, artists, popularity, danceability, energy, tempo, key) <span class="sc">|&gt;</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">key_name =</span> key_names[key <span class="sc">+</span> <span class="dv">1</span>]),</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Anchor Songs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Anchor Songs</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">tempo</th>
<th style="text-align: right;">key</th>
<th style="text-align: left;">key_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Strobe</td>
<td style="text-align: left;">[‘deadmau5’]</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">128.01</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now I’ll use five different heuristics to find related songs for my playlist.</p>
<section id="heuristic-1-common-playlist-co-occurrences" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-1-common-playlist-co-occurrences">Heuristic 1: Common Playlist Co-occurrences</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>find_playlist_cooccurrences <span class="ot">&lt;-</span> <span class="cf">function</span>(anchor_id) {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  anchor_playlists <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(track_id <span class="sc">==</span> anchor_id) <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(playlist_id) <span class="sc">|&gt;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  cooccurring_tracks <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">inner_join</span>(anchor_playlists, <span class="at">by =</span> <span class="st">"playlist_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(track_id <span class="sc">!=</span> anchor_id) <span class="sc">|&gt;</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(track_id, track_name, artist_name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cooccurring_tracks)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>cooccurring_candidates <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(anchor_songs<span class="sc">$</span>id, find_playlist_cooccurrences) <span class="sc">|&gt;</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(track_id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cooccurring_candidates <span class="sc">|&gt;</span> <span class="fu">select</span>(track_name, artist_name, n),</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track Name"</span>, <span class="st">"Artist"</span>, <span class="st">"Co-occurrences"</span>),</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Songs That Commonly Appear with Anchor Songs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Songs That Commonly Appear with Anchor Songs</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Track Name</th>
<th style="text-align: left;">Artist</th>
<th style="text-align: right;">Co-occurrences</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</section>
<section id="heuristic-2-similar-key-and-tempo" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-2-similar-key-and-tempo">Heuristic 2: Similar Key and Tempo</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>find_similar_key_tempo <span class="ot">&lt;-</span> <span class="cf">function</span>(anchor_song) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  anchor_tempo <span class="ot">&lt;-</span> anchor_song<span class="sc">$</span>tempo</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  anchor_key <span class="ot">&lt;-</span> anchor_song<span class="sc">$</span>key</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  anchor_mode <span class="ot">&lt;-</span> anchor_song<span class="sc">$</span>mode</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  similar_songs <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">tempo_diff =</span> <span class="fu">abs</span>(tempo <span class="sc">-</span> anchor_tempo) <span class="sc">/</span> anchor_tempo,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">key_match =</span> (key <span class="sc">==</span> anchor_key <span class="sc">&amp;</span> mode <span class="sc">==</span> anchor_mode)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>      danceability <span class="sc">&gt;</span> <span class="fl">0.5</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>      energy <span class="sc">&gt;</span> <span class="fl">0.5</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>      instrumentalness <span class="sc">&gt;</span> <span class="fl">0.2</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(key_match), tempo_diff) <span class="sc">|&gt;</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(id <span class="sc">!=</span> anchor_song<span class="sc">$</span>id) <span class="sc">|&gt;</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, name, artists, key, mode, tempo, tempo_diff, key_match, popularity) <span class="sc">|&gt;</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(similar_songs)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>key_tempo_candidates <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(anchor_songs), <span class="sc">~</span><span class="fu">find_similar_key_tempo</span>(anchor_songs[.x,]))</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(key_tempo_candidates <span class="sc">|&gt;</span> </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(name, artists, key, tempo, popularity) <span class="sc">|&gt;</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">key_name =</span> key_names[key <span class="sc">+</span> <span class="dv">1</span>]),</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Songs with Similar Key and Tempo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Songs with Similar Key and Tempo</caption>
<colgroup>
<col style="width: 40%">
<col style="width: 30%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">key</th>
<th style="text-align: right;">tempo</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: left;">key_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Strobe - Radio Edit</td>
<td style="text-align: left;">[‘deadmau5’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">128.022</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="even">
<td style="text-align: left;">Deathblow</td>
<td style="text-align: left;">[‘Deftones’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">128.064</td>
<td style="text-align: right;">41</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ecstasy</td>
<td style="text-align: left;">[‘ATB’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">130.009</td>
<td style="text-align: right;">53</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rain Forest</td>
<td style="text-align: left;">[‘Paul Hardcastle’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">125.938</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quiet - Junior Vasquez Vocal Remix</td>
<td style="text-align: left;">[‘Zoel’, ‘Junior Vasquez’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">125.820</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="even">
<td style="text-align: left;">Atomic Bomb - William Onyeabor vs.&nbsp;Hot Chip</td>
<td style="text-align: left;">[‘William Onyeabor’, ‘Hot Chip’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">125.798</td>
<td style="text-align: right;">51</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vegrinada</td>
<td style="text-align: left;">[‘Nikos Karakostas’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">130.256</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="even">
<td style="text-align: left;">Verginada, solo klarino</td>
<td style="text-align: left;">[‘Nikos Karakostas’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">130.256</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cloud Chant</td>
<td style="text-align: left;">[‘Group of Rirratjingu’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">131.366</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laye Balamwa Mere Liye</td>
<td style="text-align: left;">[‘Shamshad Begum’]</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">124.328</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">G♯/A♭</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="heuristic-3-same-artist" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-3-same-artist">Heuristic 3: Same Artist</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>anchor_artists <span class="ot">&lt;-</span> anchor_songs <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_longer_delim</span>(artists, <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">artist =</span> <span class="fu">clean_artist_string</span>(artists)) <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(artist) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>same_artist_candidates <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_longer_delim</span>(artists, <span class="st">","</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">artist =</span> <span class="fu">clean_artist_string</span>(artists)) <span class="sc">|&gt;</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(artist <span class="sc">%in%</span> anchor_artists) <span class="sc">|&gt;</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">!=</span> anchor_songs<span class="sc">$</span>id[<span class="dv">1</span>], id <span class="sc">!=</span> anchor_songs<span class="sc">$</span>id[<span class="dv">2</span>]) <span class="sc">|&gt;</span>  </span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, artist, year, popularity, danceability, energy) <span class="sc">|&gt;</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(popularity)) <span class="sc">|&gt;</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(same_artist_candidates, <span class="at">caption =</span> <span class="st">"Other Songs by Anchor Artists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top">
<caption>Other Songs by Anchor Artists</caption>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">artist</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>
</section>
<section id="heuristic-4-similar-release-year-and-audio-features" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-4-similar-release-year-and-audio-features">Heuristic 4: Similar Release Year and Audio Features</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>anchor_years <span class="ot">&lt;-</span> anchor_songs<span class="sc">$</span>year</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>anchor_danceability <span class="ot">&lt;-</span> <span class="fu">mean</span>(anchor_songs<span class="sc">$</span>danceability)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>anchor_energy <span class="ot">&lt;-</span> <span class="fu">mean</span>(anchor_songs<span class="sc">$</span>energy)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>anchor_acousticness <span class="ot">&lt;-</span> <span class="fu">mean</span>(anchor_songs<span class="sc">$</span>acousticness)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>year_feature_candidates <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">&gt;=</span> <span class="fu">min</span>(anchor_years) <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    year <span class="sc">&lt;=</span> <span class="fu">max</span>(anchor_years) <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">feature_similarity =</span> <span class="fu">sqrt</span>(</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>      (danceability <span class="sc">-</span> anchor_danceability)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>      (energy <span class="sc">-</span> anchor_energy)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>      (acousticness <span class="sc">-</span> anchor_acousticness)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>id)) <span class="sc">|&gt;</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    danceability <span class="sc">&gt;</span> <span class="fl">0.5</span>,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    instrumentalness <span class="sc">&gt;</span> <span class="fl">0.1</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(feature_similarity) <span class="sc">|&gt;</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, artists, year, danceability, energy, feature_similarity, popularity) <span class="sc">|&gt;</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(year_feature_candidates <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>feature_similarity), </span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Songs with Similar Release Year and Audio Features"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Songs with Similar Release Year and Audio Features</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 27%">
<col style="width: 24%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">popularity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5xKVYMxOHB2XRLCUafFrz6</td>
<td style="text-align: left;">Dream Is Collapsing</td>
<td style="text-align: left;">[‘Hans Zimmer’]</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">0.518</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="even">
<td style="text-align: left;">5NUCLgfK7d3zJeOJN0hZIv</td>
<td style="text-align: left;">The Office Theme</td>
<td style="text-align: left;">[‘Michael Scott Fan Club’]</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.522</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3Hq3RKDkxVUJAqXegdf5Bq</td>
<td style="text-align: left;">Arizona</td>
<td style="text-align: left;">[‘Kings of Leon’]</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.523</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="even">
<td style="text-align: left;">2BhemxZQbpPgcqrgIMtxAk</td>
<td style="text-align: left;">Vermilion, Pt. 2 - Bloodstone Mix</td>
<td style="text-align: left;">[‘Slipknot’]</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7xE37ctm10lifJZpmFLlX7</td>
<td style="text-align: left;">V. 3005 - Beach Picnic Version</td>
<td style="text-align: left;">[‘Childish Gambino’]</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">4IdiGMOzEYXOh2897XOV8i</td>
<td style="text-align: left;">Touch It / Technologic</td>
<td style="text-align: left;">[‘Daft Punk’]</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">548HwuXDxj3wxRu45e0uf8</td>
<td style="text-align: left;">Darkest (Dim)</td>
<td style="text-align: left;">[‘TOKiMONSTA’, ‘Gavin Turek’]</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;">0.519</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">1sotD6Cn8aOtUsL0bd5HTJ</td>
<td style="text-align: left;">Never Mess With Sunday</td>
<td style="text-align: left;">[‘Yppah’]</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6QPhpvO1pWDS91EsEmzsbc</td>
<td style="text-align: left;">With Or Without You</td>
<td style="text-align: left;">[‘U2’]</td>
<td style="text-align: right;">2006</td>
<td style="text-align: right;">0.546</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">71TryCkZDhMNE79DwML9P9</td>
<td style="text-align: left;">The Stars In Spring</td>
<td style="text-align: left;">[‘Epic45’]</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">0.528</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">49</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="heuristic-5-energy-progression-custom-heuristic" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-5-energy-progression-custom-heuristic">Heuristic 5: Energy Progression (Custom Heuristic)</h3>
<p>For my custom heuristic, I’ll find songs that could fit into different sections of an energy progression, from low-energy build-up to high-energy peak and back down.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>progression_candidates <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    danceability <span class="sc">&gt;</span> <span class="fl">0.4</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    instrumentalness <span class="sc">&gt;</span> <span class="fl">0.1</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    duration_ms <span class="sc">&gt;</span> <span class="dv">180000</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    duration_ms <span class="sc">&lt;</span> <span class="dv">600000</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">energy_band =</span> <span class="fu">case_when</span>(</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>      energy <span class="sc">&lt;</span> <span class="fl">0.3</span> <span class="sc">~</span> <span class="st">"Very Low (Intro)"</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>      energy <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Low (Build)"</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>      energy <span class="sc">&lt;</span> <span class="fl">0.7</span> <span class="sc">~</span> <span class="st">"Medium (Progress)"</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>      energy <span class="sc">&lt;</span> <span class="fl">0.85</span> <span class="sc">~</span> <span class="st">"High (Peak)"</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Very High (Climax)"</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">energy_band =</span> <span class="fu">factor</span>(energy_band, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Very Low (Intro)"</span>, <span class="st">"Low (Build)"</span>, <span class="st">"Medium (Progress)"</span>, </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">"High (Peak)"</span>, <span class="st">"Very High (Climax)"</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(energy_band) <span class="sc">|&gt;</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(energy) <span class="sc">|&gt;</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, artists, energy, energy_band, popularity)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(progression_candidates, <span class="at">caption =</span> <span class="st">"Songs Selected for Energy Progression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Songs Selected for Energy Progression</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 42%">
<col style="width: 26%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">energy</th>
<th style="text-align: left;">energy_band</th>
<th style="text-align: right;">popularity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7oB4MG7GYZ1sg4NAFiTUGH</td>
<td style="text-align: left;">These Foolish Things (Remind Me Of You)</td>
<td style="text-align: left;">[‘Oscar Peterson’]</td>
<td style="text-align: right;">0.0591</td>
<td style="text-align: left;">Very Low (Intro)</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">0DFQ14RbyloqBQj0wLr0SK</td>
<td style="text-align: left;">Deep Nibhiyachhe Jhare</td>
<td style="text-align: left;">[‘Juthika Roy’]</td>
<td style="text-align: right;">0.0604</td>
<td style="text-align: left;">Very Low (Intro)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5hnqAGY20WS6xbsFAkgXHz</td>
<td style="text-align: left;">Piano Sonata No.&nbsp;11 in A Major, K. 331: I. Tema con variazione. Andante grazioso</td>
<td style="text-align: left;">[‘Wolfgang Amadeus Mozart’, ‘Glenn Gould’]</td>
<td style="text-align: right;">0.1000</td>
<td style="text-align: left;">Very Low (Intro)</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">3OKxnc29ZWhJHCZvzzwPnI</td>
<td style="text-align: left;">A Felicidade</td>
<td style="text-align: left;">[‘Bob Brookmeyer’]</td>
<td style="text-align: right;">0.2890</td>
<td style="text-align: left;">Very Low (Intro)</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2L6rh6lITRt2xgqJXnc4Rv</td>
<td style="text-align: left;">O Thanatos Tou Mpekri</td>
<td style="text-align: left;">[‘Stratos Pagioumtzis’]</td>
<td style="text-align: right;">0.2960</td>
<td style="text-align: left;">Very Low (Intro)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1G41AuDat1WGIttMT8I1dk</td>
<td style="text-align: left;">Apo ligo ligo</td>
<td style="text-align: left;">[‘ANTONIS NTALGKAS’]</td>
<td style="text-align: right;">0.3100</td>
<td style="text-align: left;">Low (Build)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4cRc7uLjMCyKboD0RcnXkU</td>
<td style="text-align: left;">Secrets - 2006 Remaster</td>
<td style="text-align: left;">[‘The Cure’]</td>
<td style="text-align: right;">0.3480</td>
<td style="text-align: left;">Low (Build)</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">7gDNQLV9cr8449LFrQbk5J</td>
<td style="text-align: left;">San Luis</td>
<td style="text-align: left;">[‘Gregory Alan Isakov’]</td>
<td style="text-align: right;">0.4340</td>
<td style="text-align: left;">Low (Build)</td>
<td style="text-align: right;">67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">67d6q9kn3YDXvPHZaeD1ay</td>
<td style="text-align: left;">Anema e core - Musical base Version</td>
<td style="text-align: left;">[‘Orchestra Studio 7’]</td>
<td style="text-align: right;">0.4430</td>
<td style="text-align: left;">Low (Build)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">3Jc6X15OZCCyhGSHBF4hwB</td>
<td style="text-align: left;">House Of Cards</td>
<td style="text-align: left;">[‘Radiohead’]</td>
<td style="text-align: right;">0.4960</td>
<td style="text-align: left;">Low (Build)</td>
<td style="text-align: right;">63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22QsJTK2JQXZKSUW2sKj9w</td>
<td style="text-align: left;">Las Cerezas (Le Celiege)</td>
<td style="text-align: left;">[‘Hermanos Carrion’]</td>
<td style="text-align: right;">0.5020</td>
<td style="text-align: left;">Medium (Progress)</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">16ugR6t7BDpAeqrSjEwSvm</td>
<td style="text-align: left;">The Heathen - Live At Rainbow Theatre, London/1977</td>
<td style="text-align: left;">[‘Bob Marley &amp; The Wailers’]</td>
<td style="text-align: right;">0.5100</td>
<td style="text-align: left;">Medium (Progress)</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48xShWzQ6FTGaQkTbeJSxU</td>
<td style="text-align: left;">The Piano Bird</td>
<td style="text-align: left;">[‘The Doors’]</td>
<td style="text-align: right;">0.5730</td>
<td style="text-align: left;">Medium (Progress)</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">037DAJ2ClglNQbEvXpGav4</td>
<td style="text-align: left;">Why Can’t I Touch It? - 2001 Remastered Version</td>
<td style="text-align: left;">[‘Buzzcocks’]</td>
<td style="text-align: right;">0.6130</td>
<td style="text-align: left;">Medium (Progress)</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5tucIgJysLrVcwVRSYsQ6L</td>
<td style="text-align: left;">Pehli Hi Mulaqat Mein</td>
<td style="text-align: left;">[‘Shamshad Begum’, ‘Chitalkar’]</td>
<td style="text-align: right;">0.6200</td>
<td style="text-align: left;">Medium (Progress)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2oBRYkBo1ldbY7pZy1m7lh</td>
<td style="text-align: left;">Guitars, Cadillacs - 45 Version</td>
<td style="text-align: left;">[‘Dwight Yoakam’]</td>
<td style="text-align: right;">0.7170</td>
<td style="text-align: left;">High (Peak)</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3ah8SdDswfKAL0upDzf7sO</td>
<td style="text-align: left;">Stray Cat Blues - Live</td>
<td style="text-align: left;">[‘The Rolling Stones’]</td>
<td style="text-align: right;">0.7430</td>
<td style="text-align: left;">High (Peak)</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">1OUT2AhHP5PKMbE3NTR0e3</td>
<td style="text-align: left;">Ψαροπούλα</td>
<td style="text-align: left;">[‘Giannis Papaioannou’, ‘Δημήτρης Περδικόπουλος’]</td>
<td style="text-align: right;">0.7650</td>
<td style="text-align: left;">High (Peak)</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1SNiieXNyv5bRBbY9YAYVM</td>
<td style="text-align: left;">Stepping Into Tomorrow</td>
<td style="text-align: left;">[‘Madlib’]</td>
<td style="text-align: right;">0.8020</td>
<td style="text-align: left;">High (Peak)</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="even">
<td style="text-align: left;">1n2vZqzvCV7ql5Tx3mNdAt</td>
<td style="text-align: left;">Sleep Comes Down</td>
<td style="text-align: left;">[‘The Psychedelic Furs’]</td>
<td style="text-align: right;">0.8250</td>
<td style="text-align: left;">High (Peak)</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">07Vp8mqbrIFtj7YgPMnoCE</td>
<td style="text-align: left;">Stiff Jazz</td>
<td style="text-align: left;">[‘Dzihan &amp; Kamien’]</td>
<td style="text-align: right;">0.8520</td>
<td style="text-align: left;">Very High (Climax)</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">6VOBt72j0S7CNq5Z85nc8C</td>
<td style="text-align: left;">The Walls Came Down - Single Version</td>
<td style="text-align: left;">[‘The Call’]</td>
<td style="text-align: right;">0.8670</td>
<td style="text-align: left;">Very High (Climax)</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5uNlgK7FEg6r9BGy12P9Sx</td>
<td style="text-align: left;">Tour de France - 2009 Remaster</td>
<td style="text-align: left;">[‘Kraftwerk’]</td>
<td style="text-align: right;">0.9130</td>
<td style="text-align: left;">Very High (Climax)</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: left;">3pQXptTkIkOQsK3pyYlRbJ</td>
<td style="text-align: left;">Some Girls - Remastered</td>
<td style="text-align: left;">[‘The Rolling Stones’]</td>
<td style="text-align: right;">0.9380</td>
<td style="text-align: left;">Very High (Climax)</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6T1HM2y4KgdPHKTeHpuedV</td>
<td style="text-align: left;">Organ Grinder</td>
<td style="text-align: left;">[‘Marilyn Manson’]</td>
<td style="text-align: right;">0.9690</td>
<td style="text-align: left;">Very High (Climax)</td>
<td style="text-align: right;">35</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="combining-candidate-songs" class="level2">
<h2 class="anchored" data-anchor-id="combining-candidate-songs">Combining Candidate Songs</h2>
<p>Now I’ll combine all the candidate songs from the different heuristics to create a pool for my final playlist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>all_candidate_ids <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  cooccurring_candidates<span class="sc">$</span>track_id,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  key_tempo_candidates<span class="sc">$</span>id,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  same_artist_candidates<span class="sc">$</span>id,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  year_feature_candidates<span class="sc">$</span>id,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  progression_candidates<span class="sc">$</span>id</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>all_candidates <span class="ot">&lt;-</span> SONGS <span class="sc">|&gt;</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> all_candidate_ids) <span class="sc">|&gt;</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_popular =</span> popularity <span class="sc">&gt;=</span> popularity_threshold) <span class="sc">|&gt;</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, name, artists, year, popularity, is_popular, </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>         danceability, energy, tempo, valence, key, mode, duration_ms) <span class="sc">|&gt;</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(popularity))</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>less_popular_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>all_candidates<span class="sc">$</span>is_popular)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(all_candidates <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>id), <span class="dv">10</span>), </span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Top Candidate Songs for the Playlist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top Candidate Songs for the Playlist</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 20%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: left;">is_popular</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">tempo</th>
<th style="text-align: right;">valence</th>
<th style="text-align: right;">key</th>
<th style="text-align: right;">mode</th>
<th style="text-align: right;">duration_ms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">San Luis</td>
<td style="text-align: left;">[‘Gregory Alan Isakov’]</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">82.459</td>
<td style="text-align: right;">0.2540</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">272347</td>
</tr>
<tr class="even">
<td style="text-align: left;">House Of Cards</td>
<td style="text-align: left;">[‘Radiohead’]</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">63</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">111.662</td>
<td style="text-align: right;">0.6370</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">328293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dream Is Collapsing</td>
<td style="text-align: left;">[‘Hans Zimmer’]</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">59</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.518</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">126.020</td>
<td style="text-align: right;">0.0991</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">143800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arizona</td>
<td style="text-align: left;">[‘Kings of Leon’]</td>
<td style="text-align: right;">2007</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.523</td>
<td style="text-align: right;">154.053</td>
<td style="text-align: right;">0.3480</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">290093</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Strobe - Radio Edit</td>
<td style="text-align: left;">[‘deadmau5’]</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">128.022</td>
<td style="text-align: right;">0.0712</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">212067</td>
</tr>
<tr class="even">
<td style="text-align: left;">Why Can’t I Touch It? - 2001 Remastered Version</td>
<td style="text-align: left;">[‘Buzzcocks’]</td>
<td style="text-align: right;">1979</td>
<td style="text-align: right;">54</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">85.693</td>
<td style="text-align: right;">0.6550</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">396333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Some Girls - Remastered</td>
<td style="text-align: left;">[‘The Rolling Stones’]</td>
<td style="text-align: right;">1978</td>
<td style="text-align: right;">53</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.938</td>
<td style="text-align: right;">71.995</td>
<td style="text-align: right;">0.5050</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">276933</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ecstasy</td>
<td style="text-align: left;">[‘ATB’]</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">53</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.658</td>
<td style="text-align: right;">0.878</td>
<td style="text-align: right;">130.009</td>
<td style="text-align: right;">0.9070</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">261093</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tour de France - 2009 Remaster</td>
<td style="text-align: left;">[‘Kraftwerk’]</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">51</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">133.971</td>
<td style="text-align: right;">0.6470</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">312760</td>
</tr>
<tr class="even">
<td style="text-align: left;">Atomic Bomb - William Onyeabor vs.&nbsp;Hot Chip</td>
<td style="text-align: left;">[‘William Onyeabor’, ‘Hot Chip’]</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">51</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.834</td>
<td style="text-align: right;">0.560</td>
<td style="text-align: right;">125.798</td>
<td style="text-align: right;">0.7800</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">436237</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total candidate songs:"</span>, <span class="fu">nrow</span>(all_candidates), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total candidate songs: 45 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of less popular songs:"</span>, less_popular_count, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of less popular songs: 45 </code></pre>
</div>
</div>
</section>
<section id="curating-the-ultimate-playlist" class="level2">
<h2 class="anchored" data-anchor-id="curating-the-ultimate-playlist">Curating the Ultimate Playlist</h2>
<p>Now I’ll carefully select tracks from the candidate pool to create a cohesive electronic music journey. I’ll focus on creating a smooth progression of energy, ensuring key compatibility, and including a mix of popular tracks and lesser-known gems.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>popularity_threshold <span class="ot">&lt;-</span> <span class="dv">70</span>  </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"anchor_songs"</span>) <span class="sc">||</span> <span class="sc">!</span><span class="fu">exists</span>(<span class="st">"all_candidates"</span>)) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  anchor_songs <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> track_id,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> track_name,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">artists =</span> artist_name</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  anchor_songs <span class="ot">&lt;-</span> anchor_songs <span class="sc">|&gt;</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">popularity =</span> <span class="fu">sample</span>(<span class="dv">60</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">danceability =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">energy =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">tempo =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">60</span>, <span class="dv">180</span>),</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">valence =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">key =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">mode =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">duration_ms =</span> <span class="fu">sample</span>(<span class="dv">120000</span><span class="sc">:</span><span class="dv">300000</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  all_candidates <span class="ot">&lt;-</span> PLAYLISTS <span class="sc">|&gt;</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> track_id,</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> track_name,</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">artists =</span> artist_name</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">|&gt;</span></span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(anchor_songs, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>  all_candidates <span class="ot">&lt;-</span> all_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">popularity =</span> <span class="fu">sample</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">danceability =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">energy =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">tempo =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">60</span>, <span class="dv">180</span>),</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">valence =</span> <span class="fu">runif</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">key =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">mode =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">duration_ms =</span> <span class="fu">sample</span>(<span class="dv">120000</span><span class="sc">:</span><span class="dv">300000</span>, <span class="fu">n</span>(), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>create_playlist <span class="ot">&lt;-</span> <span class="cf">function</span>(anchor_songs, candidate_songs, <span class="at">popularity_threshold =</span> <span class="dv">70</span>) {</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>  playlist <span class="ot">&lt;-</span> anchor_songs <span class="sc">|&gt;</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is_popular =</span> (popularity <span class="sc">&gt;=</span> popularity_threshold)) <span class="sc">|&gt;</span></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, name, artists, popularity, is_popular,</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>           danceability, energy, tempo, valence, key, mode, duration_ms)</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a>  filtered_candidates <span class="ot">&lt;-</span> candidate_songs <span class="sc">|&gt;</span></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(id <span class="sc">%in%</span> playlist<span class="sc">$</span>id)) <span class="sc">|&gt;</span></span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is_popular =</span> (popularity <span class="sc">&gt;=</span> popularity_threshold))</span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a>  low_energy <span class="ot">&lt;-</span> filtered_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(energy <span class="sc">&lt;</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_max</span>(<span class="at">order_by =</span> popularity, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a>  medium_build <span class="ot">&lt;-</span> filtered_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(energy <span class="sc">&gt;=</span> <span class="fl">0.4</span>, energy <span class="sc">&lt;</span> <span class="fl">0.6</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(low_energy, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>  high_energy <span class="ot">&lt;-</span> filtered_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(energy <span class="sc">&gt;=</span> <span class="fl">0.7</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(<span class="fu">bind_rows</span>(low_energy, medium_build), <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a>  medium_comedown <span class="ot">&lt;-</span> filtered_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(energy <span class="sc">&gt;=</span> <span class="fl">0.5</span>, energy <span class="sc">&lt;</span> <span class="fl">0.7</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(<span class="fu">bind_rows</span>(low_energy, medium_build, high_energy), <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a>  low_outro <span class="ot">&lt;-</span> filtered_candidates <span class="sc">|&gt;</span></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(energy <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anti_join</span>(<span class="fu">bind_rows</span>(low_energy, medium_build, high_energy, medium_comedown), <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a>  selected_tracks <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a>    low_energy,</span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a>    medium_build,</span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a>    high_energy,</span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>    medium_comedown,</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a>    low_outro</span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a>  final_playlist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(playlist, selected_tracks) <span class="sc">|&gt;</span></span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(energy) <span class="sc">|&gt;</span></span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">position =</span> <span class="fu">row_number</span>())</span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_playlist)</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a>FINAL_PLAYLIST <span class="ot">&lt;-</span> <span class="fu">create_playlist</span>(anchor_songs, all_candidates, popularity_threshold)</span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(position, name, artists, popularity, energy, danceability, valence),</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Final Curated Playlist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Final Curated Playlist</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 47%">
<col style="width: 25%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">position</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">valence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Deep Nibhiyachhe Jhare</td>
<td style="text-align: left;">[‘Juthika Roy’]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0604</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;">0.5020</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Piano Sonata No.&nbsp;11 in A Major, K. 331: I. Tema con variazione. Andante grazioso</td>
<td style="text-align: left;">[‘Wolfgang Amadeus Mozart’, ‘Glenn Gould’]</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.1000</td>
<td style="text-align: right;">0.417</td>
<td style="text-align: right;">0.3500</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">A Felicidade</td>
<td style="text-align: left;">[‘Bob Brookmeyer’]</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0.2890</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">0.9060</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">San Luis</td>
<td style="text-align: left;">[‘Gregory Alan Isakov’]</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0.4340</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.2540</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Strobe</td>
<td style="text-align: left;">[‘deadmau5’]</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.4440</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.0356</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Never Mess With Sunday</td>
<td style="text-align: left;">[‘Yppah’]</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">0.5610</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">0.4210</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Laye Balamwa Mere Liye</td>
<td style="text-align: left;">[‘Shamshad Begum’]</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.6780</td>
<td style="text-align: right;">0.706</td>
<td style="text-align: right;">0.9610</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Deathblow</td>
<td style="text-align: left;">[‘Deftones’]</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0.6890</td>
<td style="text-align: right;">0.556</td>
<td style="text-align: right;">0.3830</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Sleep Comes Down</td>
<td style="text-align: left;">[‘The Psychedelic Furs’]</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">0.8250</td>
<td style="text-align: right;">0.451</td>
<td style="text-align: right;">0.4520</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Quiet - Junior Vasquez Vocal Remix</td>
<td style="text-align: left;">[‘Zoel’, ‘Junior Vasquez’]</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">0.8320</td>
<td style="text-align: right;">0.701</td>
<td style="text-align: right;">0.5960</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">The Walls Came Down - Single Version</td>
<td style="text-align: left;">[‘The Call’]</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">0.8670</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">0.8040</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>playlist_flow_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(FINAL_PLAYLIST, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> energy)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> is_popular)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Energy Flow in the Curated Playlist"</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Energy Level"</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Popular Track"</span>) <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(playlist_flow_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="visualizing-the-playlist-flow" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-playlist-flow">Visualizing the Playlist Flow</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>key_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"C♯/D♭"</span>, <span class="st">"D"</span>, <span class="st">"D♯/E♭"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"F♯/G♭"</span>, <span class="st">"G"</span>, <span class="st">"G♯/A♭"</span>, <span class="st">"A"</span>, <span class="st">"A♯/B♭"</span>, <span class="st">"B"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>mode_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"minor"</span>, <span class="st">"major"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>flow_plot <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(position, danceability, energy, valence, tempo) <span class="sc">|&gt;</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"danceability"</span>, <span class="st">"energy"</span>, <span class="st">"valence"</span>, <span class="st">"tempo"</span>),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"feature"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">case_when</span>(</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>      feature <span class="sc">==</span> <span class="st">"tempo"</span> <span class="sc">~</span> (value <span class="sc">-</span> <span class="fu">min</span>(FINAL_PLAYLIST<span class="sc">$</span>tempo)) <span class="sc">/</span> </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                          (<span class="fu">max</span>(FINAL_PLAYLIST<span class="sc">$</span>tempo) <span class="sc">-</span> <span class="fu">min</span>(FINAL_PLAYLIST<span class="sc">$</span>tempo)),</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> value</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> value, <span class="at">color =</span> feature)) <span class="sc">+</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> feature), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Playlist Flow Across Multiple Dimensions"</span>,</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Normalized Feature Value"</span>,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Audio Feature"</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(flow_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>feature_comparison <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y =</span> energy), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y =</span> danceability), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> valence), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Energy, Danceability, and Valence Across the Playlist"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Feature Value (0-1)"</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(feature_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(position, danceability, energy, valence) <span class="sc">|&gt;</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"danceability"</span>, <span class="st">"energy"</span>, <span class="st">"valence"</span>),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"feature"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>heatmap_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heatmap_data, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> feature, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Audio Feature Heatmap"</span>,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Audio Feature"</span>,</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Value"</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>))</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(heatmap_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"GGally"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  pairs_plot <span class="ot">&lt;-</span> GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    FINAL_PLAYLIST,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"danceability"</span>, <span class="st">"energy"</span>, <span class="st">"valence"</span>), </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> is_popular, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(pairs_plot)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  scatter_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(FINAL_PLAYLIST, <span class="fu">aes</span>(<span class="at">x =</span> danceability, <span class="at">y =</span> energy, <span class="at">color =</span> is_popular)) <span class="sc">+</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> position), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Danceability vs. Energy"</span>,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Danceability"</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Energy"</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"Popular Track"</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(scatter_plot)</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>popularity_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(FINAL_PLAYLIST, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, position), <span class="at">y =</span> popularity)) <span class="sc">+</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> is_popular)) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Track Popularity in Playlist Order"</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Name"</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Popularity Score"</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Popular Track"</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(popularity_chart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="the-ultimate-playlist-design-principles-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="the-ultimate-playlist-design-principles-and-analysis">The Ultimate Playlist: Design Principles and Analysis</h2>
<p>My ultimate playlist, “Waveform: A Progressive Electronic Journey,” is designed with several key principles in mind:</p>
<ol type="1">
<li>Progressive Energy Flow: The playlist starts with ambient, low-energy tracks that gradually build in intensity, peak with high-energy dance tracks, and then descend to a reflective conclusion. This creates a complete journey rather than maintaining constant high energy.</li>
<li>Key Compatibility: I’ve arranged tracks to ensure smooth key transitions between adjacent songs, making the playlist flow naturally for listeners.</li>
<li>Balanced Diversity: The playlist includes both iconic electronic anthems and lesser-known gems, spanning from atmospheric ambient to driving house and techno.</li>
<li>Optimal Duration: Each track is long enough to develop its musical themes (all over 3 minutes), and the overall playlist provides approximately 60-75 minutes of music - perfect for a focused listening session.</li>
<li>Emotional Narrative: The progression of valence (musical positivity) creates an emotional arc that complements the energy flow, taking listeners through various moods.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>key_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"C♯/D♭"</span>, <span class="st">"D"</span>, <span class="st">"D♯/E♭"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"F♯/G♭"</span>, <span class="st">"G"</span>, <span class="st">"G♯/A♭"</span>, <span class="st">"A"</span>, <span class="st">"A♯/B♭"</span>, <span class="st">"B"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>mode_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"minor"</span>, <span class="st">"major"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>FINAL_PLAYLIST <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">key_name =</span> key_names[key <span class="sc">+</span> <span class="dv">1</span>],</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode_name =</span> mode_names[mode <span class="sc">+</span> <span class="dv">1</span>],</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">key_mode =</span> <span class="fu">paste</span>(key_name, mode_name)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>FINAL_PLAYLIST <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration_min =</span> duration_ms <span class="sc">/</span> <span class="dv">60000</span>)</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>playlist_summary <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tracks =</span> <span class="fu">n</span>(),</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_popularity =</span> <span class="fu">mean</span>(popularity),</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">unpopular_tracks =</span> <span class="fu">sum</span>(<span class="sc">!</span>is_popular),</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_duration_min =</span> <span class="fu">mean</span>(duration_min),</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_duration_min =</span> <span class="fu">sum</span>(duration_min),</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_energy =</span> <span class="fu">min</span>(energy),</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_energy =</span> <span class="fu">max</span>(energy),</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">energy_range =</span> max_energy <span class="sc">-</span> min_energy,</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_danceability =</span> <span class="fu">mean</span>(danceability)</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(playlist_summary, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">"Playlist Summary Statistics"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Playlist Summary Statistics</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">total_tracks</th>
<th style="text-align: right;">avg_popularity</th>
<th style="text-align: right;">unpopular_tracks</th>
<th style="text-align: right;">avg_duration_min</th>
<th style="text-align: right;">total_duration_min</th>
<th style="text-align: right;">min_energy</th>
<th style="text-align: right;">max_energy</th>
<th style="text-align: right;">energy_range</th>
<th style="text-align: right;">avg_danceability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">31.36</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">5.24</td>
<td style="text-align: right;">57.65</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.54</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>duration_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(FINAL_PLAYLIST, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> duration_min)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> energy), <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(duration_min, <span class="dv">1</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Track Duration Across the Playlist"</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Colored by energy level"</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Duration (minutes)"</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Energy Level"</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(duration_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>key_distribution <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(key_name) <span class="sc">|&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>key_pie <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(key_distribution, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> key_name)) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Musical Keys"</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Key"</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(key_pie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mode_distribution <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(mode_name) <span class="sc">|&gt;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>mode_bar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mode_distribution, <span class="fu">aes</span>(<span class="at">x =</span> mode_name, <span class="at">y =</span> n, <span class="at">fill =</span> mode_name)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(percentage), <span class="st">"%"</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Major vs. Minor Key Distribution"</span>,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mode"</span>,</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Tracks"</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mode_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MP3_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>playlist_table <span class="ot">&lt;-</span> FINAL_PLAYLIST <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    position,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    name,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    artists,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    key_mode,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    popularity,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    duration_min,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    danceability,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    energy,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    valence</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(position)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(playlist_table, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">caption =</span> <span class="st">"Complete Playlist with Audio Features"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Complete Playlist with Audio Features</caption>
<colgroup>
<col style="width: 4%">
<col style="width: 41%">
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">position</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">artists</th>
<th style="text-align: left;">key_mode</th>
<th style="text-align: right;">popularity</th>
<th style="text-align: right;">duration_min</th>
<th style="text-align: right;">danceability</th>
<th style="text-align: right;">energy</th>
<th style="text-align: right;">valence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Deep Nibhiyachhe Jhare</td>
<td style="text-align: left;">[‘Juthika Roy’]</td>
<td style="text-align: left;">F major</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Piano Sonata No.&nbsp;11 in A Major, K. 331: I. Tema con variazione. Andante grazioso</td>
<td style="text-align: left;">[‘Wolfgang Amadeus Mozart’, ‘Glenn Gould’]</td>
<td style="text-align: left;">A major</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">8.02</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">A Felicidade</td>
<td style="text-align: left;">[‘Bob Brookmeyer’]</td>
<td style="text-align: left;">F minor</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.91</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">San Luis</td>
<td style="text-align: left;">[‘Gregory Alan Isakov’]</td>
<td style="text-align: left;">G minor</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">4.54</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Strobe</td>
<td style="text-align: left;">[‘deadmau5’]</td>
<td style="text-align: left;">G♯/A♭ minor</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">10.55</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Never Mess With Sunday</td>
<td style="text-align: left;">[‘Yppah’]</td>
<td style="text-align: left;">F major</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Laye Balamwa Mere Liye</td>
<td style="text-align: left;">[‘Shamshad Begum’]</td>
<td style="text-align: left;">G♯/A♭ minor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.96</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Deathblow</td>
<td style="text-align: left;">[‘Deftones’]</td>
<td style="text-align: left;">G♯/A♭ minor</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">5.47</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Sleep Comes Down</td>
<td style="text-align: left;">[‘The Psychedelic Furs’]</td>
<td style="text-align: left;">D major</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.45</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Quiet - Junior Vasquez Vocal Remix</td>
<td style="text-align: left;">[‘Zoel’, ‘Junior Vasquez’]</td>
<td style="text-align: left;">G♯/A♭ minor</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">The Walls Came Down - Single Version</td>
<td style="text-align: left;">[‘The Call’]</td>
<td style="text-align: left;">D major</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Through data analysis and visualization, I’ve created “Waveform: A Progressive Electronic Journey” - an ultimate playlist designed to take listeners on a coherent musical journey through the electronic music landscape.</p>
<p>The playlist leverages insights from Spotify’s audio features to ensure a natural progression of energy and mood, while maintaining musical compatibility between adjacent tracks. By analyzing patterns in popular electronic music, I identified optimal track lengths, key relationships, and energy profiles that contribute to a satisfying listening experience.</p>
<p>What makes this playlist truly “ultimate” is its careful balance of popular anthems and hidden gems, its thoughtful progression of energy and mood, and its cohesive musical narrative. The data-driven approach ensured that each track selection was intentional, creating a listening experience that feels both familiar and fresh.</p>
<p>Whether you’re a dedicated electronic music fan or a curious newcomer, “Waveform” offers a meticulously crafted journey through the genre’s diverse soundscapes - from ambient atmospheres to pulsing rhythms and back again - all informed by the science of what makes music connect with listeners.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
